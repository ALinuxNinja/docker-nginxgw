sudo: required
services:
- docker
language: php
env:
  global:
  - COMMIT=${TRAVIS_COMMIT::8}
  - secure: P8lYIJD9gUulXiWGiQ6qZ8P4uycGI1fkc8+n7qi1K1QvUi2xshKxgIv2v28kl6XeuH96GrGvZ1tkCdVrLrh5KiVwn5L1fJEHn6+Pwv6ahfMoCNxiwZLIuXSt9ZXezgBOTVLc4oqGRvgHLsstB2U+NXh5DUf2nTrUpdUNJKsUflDtCPQ0gJZrEAnkwyx9O+yam9uqxh7sZsdOlWZah8/b9NnmfE3rg5pm8Qe1mDjrccqvQuaGJOK3CB9sVYGz1umy+xwgEkP/NPNK5UPU6UG2FMuhgb0biWw3a7ArUqDC0Yx2fim0sbM/VLmzUnAY5yO7W5hbQ1Py/NH/yeG2g8V/qXoIfJVF5vJIRqraEypdAqGHGp4yl8qw+4gcPclkViN1aSvDhxQFXXJUN8N8DJu83+xBaeGnDfJa1O4lgOIllOJ+39bWNJfvDuZXF2EbhW0YhE0QBmlZkOO930E9hWTHQ5HSA/MjZtgFFjsAFuy4hKcx1TnKzIwf9tQM92VDzChCm43ItZZySGKtrISun0hvc7mzHfvCjduGqN1IuaZT7rV2AZ8Hy7nuu1D4GQLMEISoEUdJY0WTnVV6TXM5Qei6ryx8Qky974GpW1poKiUNQ3P0TKCIRjwXVsJCqMEjP6D+rNBwDbPIvux7KlonfJ79naGWPfQcm+UGHndi/AcXc4I=
  - secure: mCPVD++pPKu9DjpMhGWmdTTdaAY6ZZUqcQMoW2B14EgqMqWXYz72PFBZTdWstzmYwzqwcJSxVJatLBl9gWzdLv36sEeT5o2KBwKR+k6NTnZZrpwPGEvKA2jDLLifLOd6u/Zv8dt1IhelWDQrLSEDK3/h722bDYkWTnKdHPXYDfPlDv0THXYZVadgl/jcKoDnKYeY9sKKsvS2uD9mIPfnYGAUU89HcNgDlJaZsUkNH2PM7WlOpXfZxg3cCz9IJbOxf3cSDXihzp5uibCwPAyjYxG3nMFVOy3icje1RxTqbSb9I1YWfuKpehLClThVBvDWEePOpGNjnDq86JweHuSFlbllP7b4J4/vSbc4letUgrPaGl24NgFgknNNoVd48jlWbkvOD0KKd+g6GbsM3I8/Y3MLC14COZKcJYJi83a7+CI0fuZZ2zIdj7GJqniTXocBt7Y7eOWdG/BpYWonsqgM++ozOhJRCJKwsr0NC4qRRsn6li6zpMnZtKOaxucEbGIRukJTjkXevJkAV3PtMfCdp0n0s9ZXlAOL7D6JAPvJXe6ihyq3p+OJm7uayVDC9AUepcGzGsh5KwtWK/eQfgwWLMO6NsHTHAV0PkS+zkCDSJ9Buevd89rbRmKbIRtxszpJNsHVrPsQtD9rt8iRVDP+IG8kl0RjwFmTye1hk6YDurM=
  - secure: FgNEHAlNEP0fuZhuFBkykKlUkAQcdAsjF3hY6rsgovr45MLfQBMKEFkog7virP+4KUPDPV535IGZZg/BaygfZTuHNMQ2ob2dtyHsdb1duZdeadsiP3pxH2bQC1xZxvs8u/+/alY5Z568pBGQQCn+yUmWwxN3SSy1Eg+UQtYT3yXfUMM2auSftymoujfxTGX9gcdyH3pSU7NoFm8Fg8FDl8jc4WjA1etX9EccpYzhRBUOAS16Fv9Xaktn39P/IxCFk+eWlCM9xAzIwEOdijVv5qcFnf+L3ef333VMT4jwH7adPC2QD/TvRuL805aOZSb6BkmTsn6hGgM9dBzAxCc/Xl7c4AAykyLZugFmGdoQbcD1Ek1Fju8+lQfEXsCdFEUus8J5qJIQQGUFoLXvghE2o8jfy4LtbZQu9EpxNK+zrRfDOBs/c+6IT7YSvwbRl2YAOCFiLjcwfiIxDW5Znr3xrJfeWaQP2nZpp/CmsQewbSsudu0Ye3ZMXGzkOnFgszSARXyWmqWSAgCcpVED0Jm1ujZfM6fXSz6LgyfE/qi2F9gJo+fGHAqzKrnTOU8jY6HASzj8cbdhrF7IpSXIS4CD/oclkPV+RV1a416j9r886XcHn0IQYiRjxA3tSei93IFKNmGy0UPWXCluXCdzDDroRQcq0H4iXT/qmjQ4kHfV8ro=
after_success:
- docker login -e $DOCKER_EMAIL -u $DOCKER_USER -p $DOCKER_PASS
- export REPO=alinuxninja/nginxgw
- export TAG=`if [ "$TRAVIS_BRANCH" == "master" ]; then echo "latest"; else echo $TRAVIS_BRANCH
  ; fi`
- docker build -f Dockerfile -t $REPO:$COMMIT .
- docker tag $REPO:$COMMIT $REPO:$TAG
- docker tag $REPO:$COMMIT $REPO:travis-$TRAVIS_BUILD_NUMBER
- docker push $REPO
